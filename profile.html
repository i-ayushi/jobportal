<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Poppins", sans-serif;
        }
        
        body {
            background-color: #c9d6ff;
            background: linear-gradient(to right, #e2e2e2, #c9d6ff);
        }
        
        .container {
            background: #fff;
            width: 450px;
            padding: 1.5rem;
            margin: 50px auto;
            border-radius: 10px;
            box-shadow: 0 20px 35px rgba(0, 0, 1, 0.2);
            text-align: center;
        }
        
        .profile img {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            object-fit: cover;
            margin-bottom: 20px;
        }
        
        .profile h3 {
            margin-bottom: 10px;
            font-size: 24px;
        }
        
        .profile p {
            margin-bottom: 10px;
            font-size: 18px;
            color: #555;
        }
        
        .profile #user-role {
            font-weight: bold;
            color: hsl(327, 90%, 28%);
        }
        
        .btn, .delete-btn {
            display: inline-block;
            padding: 10px 20px;
            margin: 10px;
            text-decoration: none;
            color: white;
            border-radius: 5px;
        }
        
        .btn {
            background-color: blue;
        }
        
        .delete-btn {
            background-color: red;
        }
        
        .btn:hover, .delete-btn:hover {
            opacity: 0.8;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="profile">
            <!-- User Avatar -->
            <img id="user-avatar" src="logo.png" >

            <!-- User Details -->
            <h3 id="username">Loading...</h3>
            <p id="user-email">Loading...</p>
            <p id="user-role">Loading...</p> <!-- Display Role -->

            <!-- Buttons -->
            <a href="profile-show.html" class="btn">Update Profile</a>
            <a href="#" class="delete-btn" id="logout-btn">Logout</a>
        </div>
    </div>

    <!-- Firebase JS SDKs -->
    <script type="module">
        // import { initializeApp } from "https://www.gstatic.com/firebasejs/10.11.1/firebase-app.js";
        // import { getAuth, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.11.1/firebase-auth.js";
        // import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.11.1/firebase-firestore.js";

        // // Firebase configuration
        // const firebaseConfig = {
        //     apiKey: "AIzaSyAS3xB8yi5Yc8R9jBI3_txpqQiNe3kzsdY",
        //     authDomain: "login-form-e4c1d.firebaseapp.com",
        //     projectId: "login-form-e4c1d",
        //     storageBucket: "login-form-e4c1d.appspot.com",
        //     messagingSenderId: "4685451629",
        //     appId: "1:4685451629:web:17d844b47ea93e08580a64"
        // };

        // // Initialize Firebase
        // const app = initializeApp(firebaseConfig);
        // const auth = getAuth();
        // const db = getFirestore(app);

        // // Function to fetch user data
        // const loadUserData = async (userId) => {
        //     const userRef = doc(db, "users", userId);
        //     const userDoc = await getDoc(userRef);
        //     if (userDoc.exists()) {
        //         const userData = userDoc.data();
        //         document.getElementById("username").textContent = `${userData.firstName} ${userData.lastName}`;
        //         document.getElementById("user-email").textContent = userData.email;
        //         document.getElementById("user-role").textContent = userData.role || 'Role not assigned';
        //         document.getElementById("user-avatar").src = userData.image || 'images/default-avatar.png';
        //     } else {
        //         console.log("No such document!");
        //     }
        // };

        // // Check if the user is logged in and load profile data
        // onAuthStateChanged(auth, (user) => {
        //     if (user) {
        //         loadUserData(user.uid);
        //     } else {
        //         window.location.href = 'role-in-login.html'; // Redirect to login page if not logged in
        //     }
        // });

        // // Logout function
        // document.getElementById('logout-btn').addEventListener('click', () => {
        //     signOut(auth).then(() => {
        //         alert('You have been logged out.');
        //         window.location.href = 'role-in-login.html'; // Redirect to login page after logout
        //     }).catch((error) => {
        //         console.error("Error logging out:", error);
        //     });
        // });
        </script>
        <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.11.1/firebase-app.js";
    import { getAuth, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.11.1/firebase-auth.js";
    import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.11.1/firebase-firestore.js";

    // Firebase configuration
    const firebaseConfig = {
        apiKey: "AIzaSyAS3xB8yi5Yc8R9jBI3_txpqQiNe3kzsdY",
        authDomain: "login-form-e4c1d.firebaseapp.com",
        projectId: "login-form-e4c1d",
        storageBucket: "login-form-e4c1d.appspot.com",
        messagingSenderId: "4685451629",
        appId: "1:4685451629:web:17d844b47ea93e08580a64"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const auth = getAuth();
    const db = getFirestore(app);

//     // Function to fetch user data
//     const loadUserData = async (userId) => {
//         const userRef = doc(db, "users", userId);
//         const userDoc = await getDoc(userRef);
//         if (userDoc.exists()) {
//             const userData = userDoc.data();
//             document.getElementById("username").textContent = `${userData.firstName} ${userData.lastName}`;
//             document.getElementById("user-email").textContent = userData.email;
            
//             // Determine and set the role based on the boolean value
//             const role = userData.role ? 'Employer' : 'Job Seeker';
//             document.getElementById("user-role").textContent = role;

//             document.getElementById("user-avatar").src = userData.image || 'img.jpg';
//         } else {
//             console.log("No such document!");
//         }
    
//     };
// ;
const loadUserData = async (userId) => {
    const userRef = doc(db, "users", userId);
    const userDoc = await getDoc(userRef);
    if (userDoc.exists()) {
        const userData = userDoc.data();
        
        // Log user data for debugging
        console.log("User data:", userData);

        document.getElementById("username").textContent = `${userData.firstName} ${userData.lastName}`;
        document.getElementById("user-email").textContent = userData.email;

        // Log role data for debugging
        console.log("Role field value:", userData.role);
console.log(userData)
        // Adjust based on data type
        const role = userData.role ? 'Employer' : 'Job Seeker';
        document.getElementById("user-role").textContent = role;
        

        document.getElementById("user-avatar").src = userData.image || 'img.jpg';
        
    } else {
        console.log("No such document!");
    }
};


    // Check if the user is logged in and load profile data
    onAuthStateChanged(auth, (user) => {
        if (user) {
            loadUserData(user.uid);
        } else {
            window.location.href = 'role-in-login.html'; // Redirect to login page if not logged in
        }
    });

    // Logout function
    document.getElementById('logout-btn').addEventListener('click', () => {
        signOut(auth).then(() => {
            alert('You have been logged out.');
            window.location.href = 'role-in-login.html'; // Redirect to login page after logout
        }).catch((error) => {
            console.error("Error logging out:", error);
        });
    });

    </script>
</body>
</html>
